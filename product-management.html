<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Management - Guru Jewellery</title>
    <link rel="stylesheet" href="./CSS/styles.css">
    <link rel="stylesheet" href="./CSS/admin-panel.css">
    <link rel="stylesheet" href="./CSS/product-management.css">
</head>

<body>
    <!-- Header -->
    <header class="admin-header">
        <div class="container">
            <div class="admin-header__content">
                <h1 class="admin-header__title">üíé Product Management</h1>
                <div class="admin-header__actions">
                    <a href="admin.html" class="btn btn--secondary">‚Üê Back to Dashboard</a>
                    <button id="logoutBtn" class="btn btn--outline">Logout</button>
                </div>
            </div>
        </div>
    </header>

    <main class="product-management">
        <div class="container">
            <!-- Category Management Section -->
            <section class="product-form-section" style="border-left: 4px solid #667eea;">
                <div class="section-header">
                    <h2 class="section-title">Category Management</h2>
                </div>

                <div style="display: flex; flex-wrap: wrap; gap: 2rem;">
                    <!-- Category Form -->
                    <div style="flex: 1; min-width: 300px;">
                        <form id="categoryForm">
                            <h3 class="form-section__title">Add / Edit Category</h3>
                            <div class="form-group">
                                <label for="categoryName" class="form-label">Category Name *</label>
                                <input type="text" id="categoryName" class="form-input modern-input" required
                                    placeholder="e.g. Earrings">
                            </div>

                            <div class="form-group" style="margin-top: 1rem;">
                                <label for="parentCategoryId" class="form-label">Parent Category</label>
                                <select id="parentCategoryId" class="form-select modern-select">
                                    <option value="">-- No Parent (Top Level) --</option>
                                </select>
                            </div>

                            <div class="form-group" style="margin-top: 1rem;">
                                <label for="categoryDescription" class="form-label">Description</label>
                                <textarea id="categoryDescription" class="form-textarea" rows="2"
                                    placeholder="Short description..."></textarea>
                            </div>

                            <div class="form-group" style="margin-top: 1rem;">
                                <label for="categoryImage" class="form-label">Category Image</label>
                                <input type="file" id="categoryImage" class="form-input" accept="image/*">
                                <small class="form-help">Optional. Upload an image for this category.</small>
                            </div>

                            <div class="form-actions" style="margin-top: 1.5rem; padding-top: 1rem;">
                                <button type="submit" class="btn btn--primary" id="btnSubmitCategory">
                                    <span id="btnSubmitCategoryText">Add Category</span>
                                </button>
                                <button type="button" class="btn btn--secondary" id="btnResetCategory">Reset</button>
                            </div>
                        </form>
                    </div>

                    <!-- Category List -->
                    <div style="flex: 1.5; min-width: 300px; border-left: 1px solid #f0f0f0; padding-left: 2rem;">
                        <h3 class="form-section__title">Existing Categories</h3>
                        <div
                            style="overflow-x: auto; max-height: 500px; overflow-y: auto; border: 1px solid #e2e8f0; border-radius: 6px;">
                            <table style="width: 100%; border-collapse: collapse; font-size: 0.95rem;">
                                <thead>
                                    <tr style="background: #f8f9fa; color: #4a5568;">
                                        <th
                                            style="padding: 0.75rem; text-align: left; border-bottom: 2px solid #e2e8f0; position: sticky; top: 0; background: #f8f9fa; z-index: 1;">
                                            Name</th>
                                        <th
                                            style="padding: 0.75rem; text-align: left; border-bottom: 2px solid #e2e8f0; position: sticky; top: 0; background: #f8f9fa; z-index: 1;">
                                            Parent</th>
                                        <th
                                            style="padding: 0.75rem; text-align: left; border-bottom: 2px solid #e2e8f0; position: sticky; top: 0; background: #f8f9fa; z-index: 1;">
                                            Description</th>
                                        <th
                                            style="padding: 0.75rem; text-align: left; border-bottom: 2px solid #e2e8f0; position: sticky; top: 0; background: #f8f9fa; z-index: 1;">
                                            Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="categoryTableBody">
                                    <!-- Populated by JS -->
                                    <tr>
                                        <td colspan="4" style="text-align:center; padding: 2rem; color: #718096;">
                                            Loading categories...</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Product Upload Form -->
            <section class="product-form-section">
                <div class="section-header">
                    <h2 class="section-title">Add New Product</h2>
                </div>

                <form id="productForm" class="product-form">
                    <!-- Basic Information -->
                    <div class="form-section">
                        <h3 class="form-section__title">Basic Information</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="productName" class="form-label">Product Name *</label>
                                <input type="text" id="productName" class="form-input" required
                                    placeholder="e.g., Diamond Necklace">
                            </div>

                            <div class="form-group">
                                <label for="sku" class="form-label">SKU</label>
                                <input type="text" id="sku" class="form-input" placeholder="e.g., JWL-NK-001">
                            </div>

                            <div class="form-group">
                                <label for="brand" class="form-label">Brand</label>
                                <input type="text" id="brand" class="form-input" placeholder="e.g., Guru Jewellery">
                            </div>

                            <div class="form-group form-group--full">
                                <label for="description" class="form-label">Description *</label>
                                <textarea id="description" class="form-textarea" rows="3" required
                                    placeholder="Detailed product description..."></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- Category & Classification -->
                    <div class="form-section">
                        <h3 class="form-section__title">Category & Classification</h3>
                        <div class="form-grid">
                            <div class="form-group form-group--full">
                                <label class="form-label">Product Category Structure *</label>
                                <div class="category-hierarchy-container"
                                    style="display: flex; flex-direction: column; gap: 1rem;">
                                    <div class="form-group" style="margin-bottom: 0;">
                                        <label for="categoryLevel1" class="form-label"
                                            style="font-size: 0.85em; color: #666;">Level 1 (Main Category)</label>
                                        <select id="categoryLevel1" class="form-select modern-select" required>
                                            <option value="">-- Select Main Category --</option>
                                        </select>
                                    </div>
                                    <div class="form-group" style="margin-bottom: 0;">
                                        <label for="categoryLevel2" class="form-label"
                                            style="font-size: 0.85em; color: #666;">Level 2 (Sub Category)</label>
                                        <select id="categoryLevel2" class="form-select modern-select" disabled>
                                            <option value="">-- Select Sub Category --</option>
                                        </select>
                                    </div>
                                    <div class="form-group" style="margin-bottom: 0;">
                                        <label for="categoryLevel3" class="form-label"
                                            style="font-size: 0.85em; color: #666;">Level 3 (Child Category)</label>
                                        <select id="categoryLevel3" class="form-select modern-select" disabled>
                                            <option value="">-- Select Child Category --</option>
                                        </select>
                                    </div>
                                </div>
                                <input type="hidden" id="categoryPath">
                                <small class="form-help">Select categories in order: Main > Sub > Child</small>
                            </div>



                        </div>
                    </div>

                    <!-- Pricing -->
                    <div class="form-section">
                        <h3 class="form-section__title">Pricing</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="mrp" class="form-label">MRP (‚Çπ) *</label>
                                <input type="number" id="mrp" class="form-input" required min="0" step="0.01"
                                    placeholder="0.00">
                            </div>

                            <div class="form-group">
                                <label for="price" class="form-label">Selling Price (‚Çπ) *</label>
                                <input type="number" id="price" class="form-input" required min="0" step="0.01"
                                    placeholder="0.00">
                            </div>

                            <div class="form-group">
                                <label for="discountPercent" class="form-label">Discount %</label>
                                <input type="number" id="discountPercent" class="form-input" min="0" max="100"
                                    placeholder="0" readonly>
                            </div>
                        </div>
                    </div>

                    <!-- Product Attributes -->
                    <div class="form-section">
                        <h3 class="form-section__title">Product Attributes</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <div class="form-group">
                                    <label for="material" class="form-label">Material</label>
                                    <input type="text" id="material" class="form-input"
                                        placeholder="e.g. Brass, Copper">
                                </div>

                                <div class="form-group">
                                    <label for="color" class="form-label">Color</label>
                                    <input type="text" id="color" class="form-input" placeholder="e.g. Gold, Rose Gold">
                                </div>

                                <div class="form-group">
                                    <label for="plating" class="form-label">Plating</label>
                                    <input type="text" id="plating" class="form-input"
                                        placeholder="e.g. 1g Gold Plated">
                                </div>

                                <div class="form-group">
                                    <label for="size" class="form-label">Size</label>
                                    <input type="text" id="size" class="form-input" placeholder="e.g. Free Size, S, M">
                                </div>

                                <div class="form-group">
                                    <label for="occasion" class="form-label">Occasion</label>
                                    <input type="text" id="occasion" class="form-input"
                                        placeholder="e.g. Party, Bridal">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Inventory -->
                    <div class="form-section">
                        <h3 class="form-section__title">Inventory</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="quantity" class="form-label">Quantity *</label>
                                <input type="number" id="quantity" class="form-input" required min="0" value="0">
                            </div>

                            <div class="form-group">
                                <label class="form-label">Stock Status</label>
                                <div class="form-checkbox">
                                    <input type="checkbox" id="inStock" checked>
                                    <label for="inStock">In Stock</label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Images -->
                    <div class="form-section">
                        <h3 class="form-section__title">Product Images</h3>
                        <div class="form-group form-group--full">
                            <label for="imageUpload" class="form-label">Upload Images</label>
                            <div class="image-upload-container">
                                <input type="file" id="imageUpload" class="image-upload-input" accept="image/*"
                                    multiple>
                                <label for="imageUpload" class="image-upload-label">
                                    <span class="upload-icon">üìÅ</span>
                                    <span class="upload-text">Choose from Gallery</span>
                                    <span class="upload-hint">or drag and drop images here</span>
                                </label>
                            </div>
                            <div id="imagePreview" class="image-preview-grid"></div>
                            <small class="form-help">Select multiple images. First image will be the main product
                                image.</small>
                        </div>
                    </div>

                    <!-- Form Actions -->
                    <div class="form-actions">
                        <button type="submit" class="btn btn--primary" id="submitBtn">
                            <span id="submitBtnText">Add Product</span>
                        </button>
                        <button type="button" class="btn btn--secondary" id="resetBtn">Reset Form</button>
                    </div>
                </form>
            </section>

            <!-- Product List -->
            <section class="product-list-section">
                <div class="section-header">
                    <h2 class="section-title">Product Inventory</h2>
                    <div class="product-stats">
                        <span class="stat">Total: <strong id="totalProducts">0</strong></span>
                        <span class="stat">In Stock: <strong id="inStockCount">0</strong></span>
                    </div>
                </div>

                <!-- Search & Filter -->
                <div class="product-controls">
                    <div class="search-box">
                        <input type="search" id="searchInput" class="search-input"
                            placeholder="Search products by name...">
                        <span class="search-icon">üîç</span>
                    </div>
                    <select id="categoryFilter" class="filter-select">
                        <option value="">All Categories</option>
                    </select>
                </div>

                <!-- Products Grid -->
                <div id="productsGrid" class="products-grid">
                    <!-- Products will be loaded here -->
                </div>

                <!-- Empty State -->
                <div id="emptyState" class="empty-state" style="display: none;">
                    <p>No products found</p>
                </div>

                <!-- Loading State -->
                <div id="loadingState" class="loading-state">
                    <p>Loading products...</p>
                </div>
            </section>
        </div>
    </main>

    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="modal" style="display: none;">
        <div class="modal__overlay"></div>
        <div class="modal__content modal__content--small">
            <h3 class="modal__title">Delete Product</h3>
            <p class="modal__text">Are you sure you want to delete this product? This action cannot be undone.</p>
            <div class="modal__actions">
                <button id="confirmDeleteBtn" class="btn btn--danger">Delete</button>
                <button id="cancelDeleteBtn" class="btn btn--secondary">Cancel</button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast" role="status" aria-live="polite" aria-atomic="true"></div>

    <!-- Scripts -->
    <script src="./JS/product-service.js"></script>
    <script src="./JS/product-management.js"></script>
    <script src="./JS/category-management.js"></script>
</body>

</html>